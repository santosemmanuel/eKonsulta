<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MHO Burauen Registration</title>
        <link href="{{ url_for('static', filename='css/all.min.css') }}"
              rel="stylesheet">
        <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}"
              rel="stylesheet">
        <link href="{{ url_for('static', filename='css/styles.css') }}"
              rel="stylesheet">
        <link href="{{ url_for('static', filename='css/toastr.css') }}"
              rel="stylesheet">
        <link href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css"
              rel="stylesheet">
    </head>
    <body>
        <!-- NAVBAR -->
        <nav class="navbar navbar-expand-lg navbar-mho shadow-sm">
            <div class="container-fluid px-4">
                <a class="navbar-brand d-flex align-items-center" href="#">
                    <img src="{{ url_for('static', filename='img/MHO_Logo.jpg') }}"
                         class="mho-logo mr-2">
                    <div>
                        <i class="fa-solid fa-notes-medical me-1"></i>eKonsultaForms
                        <small>Electronic Konsulta Forms Processing System</small>
                    </div>
                </a>
                
        <!-- Right-side nav link -->
        <ul class="navbar-nav ms-auto">
            <li class="nav-item">
                <a class="nav-link text-white" href="/login">
                    <i class="fa-solid fa fa-history me-1"></i> Activity Log
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link text-white" href="/login">
                    <i class="fa-solid fa-right-to-bracket me-1"></i> Login
                </a>
            </li>
        </ul>
            </div>
        </nav>
        <!-- MAIN CONTENT -->
        <div class="container-fluid py-4">
            <div class="row g-4">
                <!-- LEFT: FORM -->
                <div class="col-lg-2">
                    <div class="card mb-3"
                         style="border-left: 10px solid #1f7a5a;
                                padding: 18px;
                                display: flex;
                                flex-direction: row;
                                justify-content: space-between;
                                align-items: flex-start;
                                flex-wrap: nowrap">
                        <div>
                            <h1 style="color: #166447; margin-bottom: 4px; font-weight: bolder;" id="MaleCount">23</h1>
                            <p style="margin: 0; color: #6c757d; font-size: 14px;">Male Patients</p>
                        </div>
                        <i class="fa-solid fa-male"
                           style="font-size: 56px;
                                  color: #6c757d;
                                  opacity: 0.2;
                                  line-height: 1;
                                  flex-shrink: 0">
                        </i>
                    </div>
                    <div class="card mb-3"
                         style="border-left: 10px solid #1f7a5a;
                                padding: 18px;
                                display: flex;
                                flex-direction: row;
                                justify-content: space-between;
                                align-items: flex-start;
                                flex-wrap: nowrap">
                        <div>
                            <h1 style="color: #166447; margin-bottom: 4px; font-weight: bolder;" id="FemaleCount">12</h1>
                            <p style="margin: 0; color: #6c757d; font-size: 14px;">Female Patients</p>
                        </div>
                        <i class="fa-solid fa-female"
                           style="font-size: 56px;
                                  color: #6c757d;
                                  opacity: 0.2;
                                  line-height: 1;
                                  flex-shrink: 0">
                        </i>
                    </div>
                    <div class="card mb-3"
                         style="border-left: 10px solid #1f7a5a;
                                padding: 18px;
                                display: flex;
                                flex-direction: row;
                                justify-content: space-between;
                                align-items: flex-start;
                                flex-wrap: nowrap">
                        <div>
                            <h1 style="color: #166447; margin-bottom: 4px; font-weight: bolder;">4</h1>
                            <p style="margin: 0; color: #6c757d; font-size: 14px;">Senior Citizen Patients</p>
                        </div>
                        <i class="fa-solid fa-person-cane"
                           style="font-size: 56px;
                                  color: #6c757d;
                                  opacity: 0.2;
                                  line-height: 1;
                                  flex-shrink: 0">
                        </i>
                    </div>
                    <div class="card mb-3"
                         style="border-left: 10px solid #1f7a5a;
                                padding: 18px;
                                display: flex;
                                flex-direction: row;
                                justify-content: space-between;
                                align-items: flex-start;
                                flex-wrap: nowrap">
                        <div>
                            <h1 style="color: #166447; margin-bottom: 4px; font-weight: bolder;">10</h1>
                            <p style="margin: 0; color: #6c757d; font-size: 14px;">Others</p>
                        </div>
                        <i class="fa-solid fa-people-group"
                           style="font-size: 56px;
                                  color: #6c757d;
                                  opacity: 0.2;
                                  line-height: 1;
                                  flex-shrink: 0">
                        </i>
                    </div>
                </div>
                <!-- RIGHT: PDF PREVIEW -->
                <div class="col-lg-10">
                    <div class="card mb-4">
                        <div class="card-header fw-semibold">Patient List</div>
                        <div class="card-body">
                            <table id="patientsTable" class="table table-striped table-bordered table-sm">
                                  <thead>
                                    <tr>
                                        <td>No.</td>
                                        <th>Member PIN</th>
                                        <th>Dependent PIN</th>
                                        <th>Name</th>
                                        <th>Municipality</th>
                                        <th>Barangay</th>
                                        <th>Sex</th>
                                    </tr>
                                </thead>
                
                            </table>
                        </div>
                    </div>
                    <!-- ðŸ“ˆ CHART CARD -->
                    <!-- <div class="card">
                        <div class="card-header fw-semibold">Patient Trend</div>
                        <div class="card-body">
                            <canvas id="patientChart" height="120"></canvas>
                        </div>
                    </div> -->
                </div>
            </div>
        </div>
        <script>
            const maleCount = {{ male_count }};
            const femaleCount = {{ female_count }};
            const patients = {{ patients | tojson }};
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="{{ url_for('static', filename='js/toastr.min.js') }}"></script>
        <script src="{{ url_for('static', filename='js/main.js')}}"></script>
        <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <!-- Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <!-- DataTables -->
        <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
        <!-- Chart.js -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            document.getElementById("MaleCount").innerHTML = maleCount;
document.getElementById("FemaleCount").innerHTML = femaleCount;

$(document).ready(function () {
    $('#patientsTable').DataTable({
        data: patients,
        columns: [
            { 
                data: null,
                render: function (data, type, row, meta) {
                    return meta.row + meta.settings._iDisplayStart + 1;
                }
            },
            { data: 'MemberPIN' },
            { data: 'DependentPIN' },
            { data: 'Name' },
            { data: 'Municipality' },
            { data: 'Barangay' },
            { data: 'Sex' }
        ],
        pageLength: 10
    });
});
            </script>
        <script>
const ctx = document.getElementById('patientChart').getContext('2d');

new Chart(ctx, {
    type: 'line',
    data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
        datasets: [{
            label: 'Registered Patients',
            data: [10, 15, 8, 20, 25],
            borderColor: '#1f7a5a',
            backgroundColor: 'rgba(31, 122, 90, 0.2)',
            pointBackgroundColor: '#1f7a5a',
            pointBorderColor: '#1f7a5a',
            tension: 0.1,
            fill: false
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: true
            }
        },
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
        </script>
    </body>
</html>
